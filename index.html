<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP32 Realtime Monitoring</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to right, #e0f7fa, #ffffff);
        margin: 0;
        padding: 20px;
        text-align: center;
    }
    h1 {
        color: #00796b;
        margin-bottom: 20px;
    }
    .dashboard {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
    }
    .card {
        background: white;
        padding: 20px 25px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        min-width: 180px;
        transition: transform 0.2s;
    }
    .card:hover {
        transform: scale(1.05);
    }
    .label {
        font-weight: bold;
        color: #00796b;
    }
    .value {
        font-size: 1.5em;
        margin-top: 5px;
        color: #004d40;
    }
    .alert {
        color: white;
        background: red;
        font-weight: bold;
        padding: 10px;
        border-radius: 10px;
        margin-top: 20px;
        display: inline-block;
        min-width: 250px;
        transition: all 0.3s;
    }
    .alert.safe {
        background: green;
        color: white;
    }
</style>
</head>
<body>

<h1>ESP32 Realtime Monitoring Dashboard</h1>

<div class="dashboard">
    <div class="card">
        <div class="label">Health</div>
        <div class="value" id="health">--</div>
    </div>
    <div class="card">
        <div class="label">Voltage (mV)</div>
        <div class="value" id="voltage">--</div>
    </div>
    <div class="card">
        <div class="label">Surface Temp (°C)</div>
        <div class="value" id="surfaceTemp">--</div>
    </div>
    <div class="card">
        <div class="label">Inner Temp (°C)</div>
        <div class="value" id="innerTemp">--</div>
    </div>
    <div class="card">
        <div class="label">Accel X</div>
        <div class="value" id="ax">--</div>
    </div>
    <div class="card">
        <div class="label">Accel Y</div>
        <div class="value" id="ay">--</div>
    </div>
    <div class="card">
        <div class="label">Accel Z</div>
        <div class="value" id="az">--</div>
    </div>
</div>

<div id="alerts" class="alert safe">No Alerts</div>

<script>
cconst backendURL = "wss://geo-polymer-brick-backend.onrender.com:10000";
const ws = new WebSocket(backendURL);

ws.onopen = () => console.log("Connected to backend WebSocket");

ws.onmessage = (e) => {
    const d = JSON.parse(e.data);

    // Update values
    document.getElementById("health").innerText = d.health.toFixed(2);
    document.getElementById("voltage").innerText = d.voltage.toFixed(2);
    document.getElementById("surfaceTemp").innerText = d.surfaceTemp.toFixed(2);
    document.getElementById("innerTemp").innerText = d.innerTemp.toFixed(2);
    document.getElementById("ax").innerText = d.accelX.toFixed(2);
    document.getElementById("ay").innerText = d.accelY.toFixed(2);
    document.getElementById("az").innerText = d.accelZ.toFixed(2);

    // Update alert box
    const alerts = [];
    if(d.earthquakeAlert) alerts.push("⚠ Earthquake Detected!");
    if(d.weakBrickWarning) alerts.push("⚠ Weak Brick!");

    const alertBox = document.getElementById("alerts");
    if(alerts.length) {
        alertBox.innerText = alerts.join(" | ");
        alertBox.classList.remove("safe");
    } else {
        alertBox.innerText = "No Alerts";
        alertBox.classList.add("safe");
    }
};

ws.onclose = () => console.log("WebSocket disconnected");
ws.onerror = (err) => console.error("WebSocket error:", err);
</script>

</body>
</html>
